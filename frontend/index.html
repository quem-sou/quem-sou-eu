<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Quem Sou Eu</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #121212;
      color: #fff;
      text-align: center;
      padding: 40px;
    }

    h1 {
      margin-bottom: 10px;
    }

    select, input, button {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
    }

    button {
      cursor: pointer;
    }

    #respostas {
      margin-top: 20px;
      min-height: 120px;
      background: #1e1e1e;
      padding: 15px;
      border-radius: 5px;
      text-align: left;
    }

    .linha {
      margin-bottom: 8px;
    }

    .pergunta {
      color: #8ecae6;
    }

    .resposta {
      color: #ffd166;
    }

    .resultado {
      font-size: 20px;
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
</head>

<body>

  <h1>üé≠ Quem Sou Eu</h1>
  <p>Escolhe uma categoria e tenta adivinhar a personagem</p>

  <!-- CATEGORIA -->
  <select id="categoria">
    <option value="">-- escolher categoria --</option>
    <option value="cinema">Cinema / TV</option>
    <option value="historia">Hist√≥ria</option>
    <option value="ciencia">Ci√™ncia</option>
    <option value="politica">Pol√≠tica</option>
  </select>

  <button onclick="iniciarJogo()">Iniciar Jogo</button>

  <hr>

  <!-- PERGUNTAS -->
  <input
    type="text"
    id="pergunta"
    placeholder="Faz uma pergunta (sim/n√£o)"
    size="40"
  />
  <button onclick="enviarPergunta()">Perguntar</button>

  <br><br>

  <!-- ADIVINHAR -->
  <input
    type="text"
    id="nome"
    placeholder="Adivinha o nome"
    size="30"
  />
  <button onclick="adivinhar()">Adivinhar</button>

  <br><br>

  <button onclick="resetar()">Reiniciar Jogo</button>

  <!-- RESPOSTAS -->
  <div id="respostas"></div>

  <div id="resultado" class="resultado"></div>

  <script>
    const API = "http://localhost:3000";

    function escreverPerguntaResposta(p, r) {
      const div = document.getElementById("respostas");
      div.innerHTML += `
        <div class="linha">
          <span class="pergunta">‚ùì ${p}</span><br>
          <span class="resposta">‚û° ${r}</span>
        </div>
      `;
      div.scrollTop = div.scrollHeight;
    }

    async function iniciarJogo() {
      const categoria = document.getElementById("categoria").value;

      if (!categoria) {
        alert("Escolhe uma categoria");
        return;
      }

      await fetch(`${API}/start`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ categoria })
      });

      document.getElementById("respostas").innerHTML = "";
      document.getElementById("resultado").innerText = "";

      alert("Jogo iniciado! Faz perguntas.");
    }

    async function enviarPergunta() {
      const pergunta = document.getElementById("pergunta").value;
      if (!pergunta) return;

      const res = await fetch(`${API}/pergunta`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ pergunta })
      });

      const data = await res.json();
      escreverPerguntaResposta(pergunta, data.resposta);

      document.getElementById("pergunta").value = "";
    }

    async function adivinhar() {
      const nome = document.getElementById("nome").value;
      if (!nome) return;

      const res = await fetch(`${API}/adivinhar`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ nome })
      });

      const data = await res.json();

      document.getElementById("resultado").innerText = data.mensagem;

      if (data.resultado === "certo") {
        document.getElementById("nome").value = "";
      }
    }

    async function resetar() {
      await fetch(`${API}/reset`, { method: "POST" });
      document.getElementById("respostas").innerHTML = "";
      document.getElementById("resultado").innerText = "";
      alert("Jogo reiniciado");
    }
  </script>

</body>
</html>